#!/usr/bin/env ruby

require "bundler/setup"
require "irb"
require File.expand_path("#{File.dirname(__FILE__)}/../lib/tic_tac_toe.rb")

board_setup = Model::BoardSetup.new(
  dimensions: 3,
  board_klass: Model::Board,
  tile_collection_klass: Model::TileCollection,
  team_collection_klass: Model::TeamCollection,
  game_state: Model::GameState,
  tile_klass: Model::Tile
)

teams_setup = Model::TeamsSetup.new(
  team_klass: Model::Team,
  piece_klass: Model::Piece,
  move_klass: Model::Move,
  move_strategy_klass: Model::MoveStrategy
)

board_setup_controller = Controller::BoardSetup.new(board_setup, teams_setup)
board_setup_view = View::BoardSetup.new(board_setup_controller)

board_setup_view.render

board = board_setup.create_board
board_controller = Controller::Board.new(board, Model::GameTree)
board_view = View::Board.new(board_controller, Terminal::Table)
game_result_view = View::GameResult.new(board_controller)
select_move_view = View::SelectMove.new(board_controller)

while board_controller.continue?
  Utils::Terminal.clear_screen
  board_view.render
  select_move_view.render
end

Utils::Terminal.clear_screen
board_view.render
game_result_view.render